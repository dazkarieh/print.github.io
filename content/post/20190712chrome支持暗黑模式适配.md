+++
title= "chrome 76å¼€å¯æš—é»‘æ¨¡å¼é€‚é…"
date= 2019-07-12T11:38:34+08:00
type = "post"
categories = ["æŠ€æœ¯"]
draft = false
toc = true
comments = false
reward = true
mathjax = false
codes = ["bash","html"]
slug = "Chrome 76 beta switch hugo dark theme with prefers-color-scheme"
keywords = ["chrome","prefers-color-scheme","dark mode","hugo"]
+++
ğŸ‰ğŸ‰ä¸€ä¸ªæ™®å¤§å–œå¥”çš„å¥½æ¶ˆæ¯ï¼šæœ€æ–°çš„Chrome 76 Betaç‰¹æ€§æ›´æ–°è¯´æ˜[^1]ï¼Œå·²ç»å®£å‘Šæ­£å¼æ”¯æŒâ€œprefers-color-scheme(ä»¥ä¸‹ç®€ç§°PCS)â€CSSé€‰é¡¹ã€‚è¿™ä¸ªé€‰é¡¹æœ‰å•¥ç”¨å‘¢ï¼Ÿ

å¦‚æœæµè§ˆå™¨æ”¯æŒè¿™ä¸€é€‰é¡¹ï¼Œè€Œæ‚¨çš„ç½‘ç«™æ°å¥½æ”¯æŒdark modeä¸»é¢˜ï¼Œæ‚¨æ— éœ€åˆ‡æ¢ä»»ä½•å†…å®¹ï¼Œå› ä¸ºæµè§ˆå™¨ä¼šä¸ºæ‚¨å¤„ç†æ—¥é—´/å¤œé—´ä¸»é¢˜åˆ‡æ¢ï¼Œä½ å°±ä¸éœ€è¦è£…Dark Readerã€Night Eyeã€High Contrastã€Turn Off the Lightsç­‰è¯¸å¦‚æ­¤ç±»çš„chromeæ‰©å±•[^2]ã€‚
<!--more-->
## PCSæ˜¯ä½•æ–¹å¦–å­½ï¼Ÿ

æ ¹æ®æœ€æ—©æ”¯æŒPCSçš„[Firefoxæ–‡æ¡£](https://webflow.com/website/CSS-Color-Scheme-prefers-dark)ä»‹ç»ï¼š

>The prefers-color-scheme CSS media feature is used to detect if the user has requested the system use a light or dark color theme.

è‡ªmacOS Mojaveå¼•å…¥äº†æš—é»‘æ¨¡å¼ä¸»é¢˜åï¼Œè¶Šæ¥è¶Šå¤šç¬¬ä¸‰æ–¹Appè¿›è¡Œäº†ç›¸å…³é€‚é…ï¼Œå¯ç”¨æˆ·ä½¿ç”¨æœ€å¤šçš„æµè§ˆå™¨å´æ²¡èƒ½å¾ˆå¥½çš„æ”¯æŒï¼Œç©¶å…¶åŸå› ï¼Œä¸»è¦æœ‰ä¸¤ä¸ªï¼Œä¸€æ˜¯æµè§ˆå™¨æ²¡æœ‰ç»™å‡ºè®©å¼€å‘è€…é€‚é…çš„æ¥å£ï¼ŒäºŒæ˜¯ç½‘ç«™è®¾è®¡å¹¶ä¸ç»Ÿä¸€ï¼Œå¼ºè¡Œè¿›å…¥æš—é»‘æ¨¡å¼ä¼šç ´åé¡µé¢çš„è®¾è®¡å’Œå†…å®¹çš„å¯è¯»æ€§ã€‚

2019å¹´ä¼Šå§‹ï¼ŒmacOSç»ˆäºåŠ å…¥äº†æ–°çš„åª’ä½“æŸ¥è¯¢`prefers-color-scheme`ï¼Œç´§æ¥ç€ï¼Œå„è·¯æµè§ˆå™¨ç»ˆäºåœ¨PCç«¯æ–°ç‰ˆæœ¬ä¸­ï¼Œé™†ç»­å¢åŠ äº†å¯¹PCSç‰¹æ€§çš„æ”¯æŒï¼Œä¾æ¬¡æ˜¯firefox 67 ->  safari 12.1 -> egdge 76 -> chrome 76ï¼Œåœ¨è¿™ä¸€æ–¹é¢ï¼ŒChromeè¿œè¿œè½ä¼äºFirefoxã€Safariç”šè‡³Edgeã€‚ä½†æ˜¯è€è°šäº‘ï¼šbetter late than neverï¼Œä¸æ˜¯ä¹ˆ?

{{< img src="https://ian2.oss-cn-hangzhou.aliyuncs.com/clt6/20190712120550.png" alt="caniuseçš„prefers-color-schemeè°±ç³»å›¾">}}

```
Name:   prefers-color-scheme
For:    @media
Value:  no-preference | light | dark
```

æ ¹æ® css è‰æ¡ˆä»‹ç»ï¼ŒPCSå±æ€§æœ‰ä¸‰ä¸ªå€¼:`dark`, `light`, `no-preference`

- no-preference: æ­¤ç”¨æˆ·ç³»ç»Ÿå¹¶æ²¡æœ‰è®¾ç½®ç›¸å…³çš„å€¼
- dark: æš—é»‘æ¨¡å¼(æš—é»‘èƒŒæ™¯+æµ…è‰²æ–‡å­—)
- light: æµ…è‰²æ¨¡å¼(æµ…è‰²èƒŒæ™¯+æš—é»‘æ–‡å­—)

å¦‚æœæƒ³äº†è§£æ›´å¤šä¿¡æ¯ï¼Œè¯·å…³æ³¨è¿™ç¯‡é¢˜ä¸ºã€Š[Hello Darkness, My Old Friend](https://web.dev/blog)ã€‹çš„æ–‡ç« ã€‚

## å¦‚ä½•é€‚é…PCSç‰¹æ€§

ä»¥æœ¬ä¸»é¢˜ä¸ºä¾‹ï¼Œç¼–è¾‘HUGOä¸»é¢˜çš„layout-headerä»£ç ï¼ˆæ¯ä¸ªä¸»é¢˜ä½ç½®å„å¼‚ï¼‰ï¼Œå°†ä¸‹åˆ—ä»£ç å†™å…¥headæ ‡ç­¾å†…[^3][^4]ï¼Œä¸€èˆ¬ç½‘ç«™é»˜è®¤éƒ½æ˜¯lightæ¨¡å¼çš„ï¼Œæ‰€ä»¥åªå†™å…¥darkæ¨¡å¼çš„æ ·å¼å³å¯ï¼š

```html
<style>
@media (prefers-color-scheme: dark) {
  /* styles for users who prefer UIs with dark themes */
}
</style>
```

```html
<script>
if (matchMedia('(prefers-color-scheme: dark)').matches) {
  // conditional JavaScript code for such users
}
</script>
```
## æŒ‡å®šä¸“ç”¨æ‰“å°æ ·å¼

æš—é»‘æ¨¡å¼ä¸‹ï¼Œæ‰“å°ç½‘ç«™å¯èƒ½ä¼šå°†é»‘è‰²èƒŒæ™¯ä¹Ÿæ‰“å°å‡ºæ¥ï¼Œå› æ­¤ï¼Œæœ‰å¿…è¦ä¸ºæ‰“å°æœºæŒ‡å®šä¸“ç”¨çš„æ‰“å°æ ·å¼ï¼Œä¾‹å¦‚ï¼š

```html
<link rel="stylesheet" media="print" href="my-print-style.css">
```
æˆ–è€…äº¦å¯ä½¿ç”¨ç°æˆæ¡†æ¶åº“[Gutenbergæ–¹æ¡ˆ](https://github.com/BafS/Gutenberg)

```html
<link rel="stylesheet" href="https://unpkg.com/gutenberg-css@0.4" media="print">
<link rel="stylesheet" href="https://unpkg.com/gutenberg-css@0.4/dist/themes/oldstyle.min.css" media="print">
```

ğŸ™ˆğŸ™ˆä¸€ä¸ªäººè‰°ä¸æ‹†çš„åæ¶ˆæ¯ï¼šæœ¬HUGOä¸»é¢˜ç½®å…¥ä»£ç åï¼Œå¹¶ä¸èƒ½å¦‚æ„¿åˆ‡æ¢dark modeï¼ŒåŸå› æœªçŸ¥ï¼Œä¹Ÿè®¸ä¸æœ¬ä¸»é¢˜å·²ç»å¯ç”¨toggleThemeåŠŸèƒ½åˆ‡æ¢æš—é»‘ä¸»é¢˜æœ‰å…³ï¼Œå…·ä½“è¦ç­‰é—²æš‡æ’æŸ¥åæ‰èƒ½ç¡®è®¤ã€‚

[^1]: [Chrome Platform Status Feature44 milestone=76](https://www.chromestatus.com/features#milestone%3D76)
[^2]: [Using dark mode in CSS with MacOS Mojave](https://paulmillr.com/posts/using-dark-mode-in-css/)
[^3]: [How can I use dark mode on my site](http://css-color-scheme-prefers-dark.webflow.io/)
[^4]: [CSS prefers-color-scheme media feature in Safari Technology Preview](https://webplatform.news/issues/2018-10-26)
